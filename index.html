<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="Meet Xiaohan Zhang, a Seattle-based photographer, chef, and digital marketer."
        />
        <title>
            Xiaohan Zhang - Photographer, chef, digital marketer in Seattle, WA
        </title>
        <!-- Google tag (gtag.js) -->
        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=G-Q9KSP1VH2F"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "G-Q9KSP1VH2F");
        </script>

        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/5.4.4/photoswipe.min.css"
        />

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
                line-height: 1.6;
                color: #000;
                background: #fff;
                font-size: 16px;
                letter-spacing: -0.01em;
            }

            .container {
                max-width: 1120px;
                margin: 0 auto;
                padding: 0 20px;
            }

            .header {
                padding: 60px 0 40px;
                text-align: center;
                border-bottom: 1px solid #e8e8e8;
                margin-bottom: 60px;
            }

            .header h1 {
                font-size: 2.5rem;
                font-weight: 400;
                margin-bottom: 20px;
                letter-spacing: -0.02em;
            }

            .header p {
                font-size: 1.1rem;
                color: #666;
                font-weight: 300;
                max-width: 600px;
                margin: 0 auto 30px;
            }

            .contact-info {
                font-size: 0.95rem;
                color: #888;
            }

            .contact-info a {
                color: #000;
                text-decoration: none;
                border-bottom: 1px solid transparent;
                transition: border-bottom 0.2s ease;
            }

            .contact-info a:hover {
                border-bottom: 1px solid #000;
            }

            .gallery {
                margin-bottom: 80px;
                opacity: 0;
                transition: opacity 0.5s ease;
            }

            .gallery.loaded {
                opacity: 1;
            }

            .gallery-row {
                display: flex;
                gap: 7px;
                margin-bottom: 7px;
                height: 400px;
            }

            .gallery-item {
                position: relative;
                overflow: hidden;
                cursor: pointer;
                background: #f8f8f8;
                transition: opacity 0.3s ease;
            }

            .gallery-item:hover {
                opacity: 0.85;
            }

            .gallery-item img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                display: block;
                transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            }

            .gallery-item:hover img {
                transform: scale(1.03);
            }

            .image-overlay {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                background: linear-gradient(transparent, rgba(0, 0, 0, 0.4));
                color: white;
                padding: 30px 20px 20px;
                opacity: 0;
                transition: opacity 0.3s ease;
                font-size: 0.9rem;
                font-weight: 300;
            }

            .gallery-item:hover .image-overlay {
                opacity: 1;
            }

            .gallery-item.loading {
                background: #f0f0f0;
                animation: pulse 1.5s ease-in-out infinite;
            }

            @keyframes pulse {
                0%,
                100% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.7;
                }
            }

            .footer {
                text-align: center;
                padding: 60px 0;
                border-top: 1px solid #e8e8e8;
                font-size: 0.9rem;
                color: #888;
            }

            .back-to-top {
                display: inline-block;
                margin-top: 20px;
                color: #000;
                text-decoration: none;
                font-weight: 400;
                transition: transform 0.2s ease;
            }

            .back-to-top:hover {
                transform: translateY(-2px);
            }

            /* Responsive Design */
            @media (max-width: 1024px) {
                .container {
                    padding: 0 16px;
                }
                .header {
                    padding: 50px 0 35px;
                    margin-bottom: 50px;
                }
                .header h1 {
                    font-size: 2.2rem;
                }
                .gallery-row {
                    height: 350px;
                }
            }

            @media (max-width: 768px) {
                .container {
                    padding: 0 15px;
                }
                .header {
                    padding: 40px 0 30px;
                    margin-bottom: 40px;
                }
                .header h1 {
                    font-size: 2rem;
                }
                .header p {
                    font-size: 1rem;
                }
                .footer {
                    padding: 40px 0;
                }

                .gallery-row {
                    display: block;
                    height: auto;
                    margin-bottom: 0;
                    gap: 0;
                }

                .gallery-item {
                    display: block;
                    width: 100% !important;
                    height: auto !important;
                    margin-bottom: 15px;
                    flex: none !important;
                }

                .gallery-row:last-child .gallery-item:last-child {
                    margin-bottom: 0;
                }

                .gallery-item img {
                    width: 100%;
                    height: auto;
                    object-fit: contain;
                    object-position: center;
                }

                .gallery-item:hover {
                    opacity: 1;
                }
                .gallery-item:hover img {
                    transform: none;
                }
                .image-overlay {
                    display: none;
                }
            }

            @media (max-width: 480px) {
                .container {
                    padding: 0 12px;
                }
                .header {
                    padding: 30px 0 25px;
                    margin-bottom: 30px;
                }
                .header h1 {
                    font-size: 1.8rem;
                }
                .header p {
                    font-size: 0.95rem;
                }
                .contact-info {
                    font-size: 0.9rem;
                }
                .gallery-item {
                    margin-bottom: 12px;
                }
                .footer {
                    padding: 30px 0;
                    font-size: 0.85rem;
                }
            }

            @media (max-width: 360px) {
                .container {
                    padding: 0 10px;
                }
                .header h1 {
                    font-size: 1.6rem;
                }
                .header p {
                    font-size: 0.9rem;
                }
                .contact-info {
                    font-size: 0.85rem;
                }
                .gallery-item {
                    margin-bottom: 10px;
                }
            }

            /* PhotoSwipe Custom Styling */
            .pswp__bg {
                background: #fff !important;
            }
            .pswp__ui {
                color: #000 !important;
            }
            .pswp__top-bar {
                background: rgba(255, 255, 255, 0.9) !important;
                backdrop-filter: blur(10px);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header class="header">
                <h1>Xiaohan Zhang</h1>
                <p>Photographer, chef, digital marketer in Seattle, WA</p>
                <div class="contact-info">
                    <a href="mailto:xiaohan.zhang14@gmail.com"
                        >xiaohan.zhang14@gmail.com</a
                    >
                    |
                    <a
                        href="https://www.instagram.com/justxiaohan/"
                        target="_blank"
                        >@justxiaohan</a
                    >
                </div>
            </header>

            <div class="gallery" id="gallery"></div>

            <footer class="footer">
                <p>
                    Shot on Sony a7cii, Sony a6300, iPhone 12 mini, and iPhone
                    15 Pro
                </p>
                <a href="#" class="back-to-top">↑ Back to Top</a>
            </footer>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/5.4.4/photoswipe.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/5.4.4/photoswipe-lightbox.min.js"></script>

        <script>
            // Configuration
            const TARGET_HEIGHT = 400;
            const GAP = 7;
            const ROW_PATTERN = [4, 2, 3, 2, 5];

            // Updated IMAGES array with thumbnails for display and originals for PhotoSwipe
            const IMAGES = [
                {
                    src: "./thumbnails/image_1.jpeg",
                    fullSrc: "./images/image_1.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_2.jpeg",
                    fullSrc: "./images/image_2.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_3.jpeg",
                    fullSrc: "./images/image_3.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_4.jpeg",
                    fullSrc: "./images/image_4.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_5.jpeg",
                    fullSrc: "./images/image_5.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_6.jpeg",
                    fullSrc: "./images/image_6.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_7.jpeg",
                    fullSrc: "./images/image_7.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_8.jpeg",
                    fullSrc: "./images/image_8.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_9.jpeg",
                    fullSrc: "./images/image_9.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_10.jpeg",
                    fullSrc: "./images/image_10.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_11.jpeg",
                    fullSrc: "./images/image_11.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_12.jpeg",
                    fullSrc: "./images/image_12.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_13.jpeg",
                    fullSrc: "./images/image_13.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_14.jpeg",
                    fullSrc: "./images/image_14.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_15.jpeg",
                    fullSrc: "./images/image_15.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_16.jpeg",
                    fullSrc: "./images/image_16.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_17.jpeg",
                    fullSrc: "./images/image_17.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_18.jpeg",
                    fullSrc: "./images/image_18.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_19.jpeg",
                    fullSrc: "./images/image_19.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_20.jpeg",
                    fullSrc: "./images/image_20.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_21.jpeg",
                    fullSrc: "./images/image_21.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_22.jpeg",
                    fullSrc: "./images/image_22.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_23.jpeg",
                    fullSrc: "./images/image_23.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_24.jpeg",
                    fullSrc: "./images/image_24.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_25.jpeg",
                    fullSrc: "./images/image_25.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_26.jpeg",
                    fullSrc: "./images/image_26.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_27.jpeg",
                    fullSrc: "./images/image_27.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_28.jpeg",
                    fullSrc: "./images/image_28.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_29.jpeg",
                    fullSrc: "./images/image_29.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_30.jpeg",
                    fullSrc: "./images/image_30.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_31.jpeg",
                    fullSrc: "./images/image_31.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_32.jpeg",
                    fullSrc: "./images/image_32.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_33.jpeg",
                    fullSrc: "./images/image_33.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_34.jpeg",
                    fullSrc: "./images/image_34.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_35.jpeg",
                    fullSrc: "./images/image_35.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_36.jpeg",
                    fullSrc: "./images/image_36.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_37.jpeg",
                    fullSrc: "./images/image_37.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_38.jpeg",
                    fullSrc: "./images/image_38.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_39.jpeg",
                    fullSrc: "./images/image_39.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_40.jpeg",
                    fullSrc: "./images/image_40.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_41.jpeg",
                    fullSrc: "./images/image_41.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_42.jpeg",
                    fullSrc: "./images/image_42.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_43.jpeg",
                    fullSrc: "./images/image_43.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_44.jpeg",
                    fullSrc: "./images/image_44.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_45.jpeg",
                    fullSrc: "./images/image_45.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_46.jpeg",
                    fullSrc: "./images/image_46.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_47.jpeg",
                    fullSrc: "./images/image_47.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_48.jpeg",
                    fullSrc: "./images/image_48.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_49.jpeg",
                    fullSrc: "./images/image_49.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_50.jpeg",
                    fullSrc: "./images/image_50.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_51.jpeg",
                    fullSrc: "./images/image_51.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_52.jpeg",
                    fullSrc: "./images/image_52.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_53.jpeg",
                    fullSrc: "./images/image_53.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_54.jpeg",
                    fullSrc: "./images/image_54.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_55.jpeg",
                    fullSrc: "./images/image_55.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_56.jpeg",
                    fullSrc: "./images/image_56.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_57.jpeg",
                    fullSrc: "./images/image_57.jpeg",
                    alt: "",
                    title: "",
                },
                {
                    src: "./thumbnails/image_58.jpeg",
                    fullSrc: "./images/image_58.jpeg",
                    alt: "",
                    title: "",
                },
            ];

            // Core Functions
            function generateGallery() {
                const gallery = document.getElementById("gallery");
                let imageIndex = 0;
                let patternIndex = 0;

                while (imageIndex < IMAGES.length) {
                    const imagesInThisRow =
                        ROW_PATTERN[patternIndex % ROW_PATTERN.length];
                    const row = document.createElement("div");
                    row.className = "gallery-row";

                    for (
                        let i = 0;
                        i < imagesInThisRow && imageIndex < IMAGES.length;
                        i++
                    ) {
                        const { src, fullSrc, alt, title } = IMAGES[imageIndex];
                        const item = document.createElement("div");
                        item.className = "gallery-item loading";
                        item.dataset.pswpWidth = "1920";
                        item.dataset.pswpHeight = "1080";
                        item.dataset.fullSrc = fullSrc; // Store full-size image path
                        item.innerHTML = `
                            <img src="${src}" alt="${alt}" />
                            ${title ? `<div class="image-overlay">${title}</div>` : ""}
                        `;
                        row.appendChild(item);
                        imageIndex++;
                    }
                    gallery.appendChild(row);
                    patternIndex++;
                }
            }

            function loadImage(src) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () =>
                        resolve({
                            width: img.naturalWidth,
                            height: img.naturalHeight,
                            aspectRatio: img.naturalWidth / img.naturalHeight,
                        });
                    img.onerror = reject;
                    img.src = src;
                });
            }

            function calculateRowLayout(images, containerWidth) {
                const totalAspectRatio = images.reduce(
                    (sum, img) => sum + img.aspectRatio,
                    0,
                );
                const availableWidth =
                    containerWidth - GAP * (images.length - 1);
                const calculatedHeight = availableWidth / totalAspectRatio;
                const constrainedHeight = Math.max(
                    TARGET_HEIGHT * 0.6,
                    Math.min(TARGET_HEIGHT * 1.8, calculatedHeight),
                );
                const idealTotalWidth = images.reduce(
                    (sum, img) => sum + img.aspectRatio * constrainedHeight,
                    0,
                );
                const scaleFactor = availableWidth / idealTotalWidth;
                const widths = images.map(
                    (img) => img.aspectRatio * constrainedHeight * scaleFactor,
                );

                return { height: constrainedHeight, widths };
            }

            async function layoutRow(row) {
                const items = Array.from(row.querySelectorAll(".gallery-item"));
                const images = [];

                for (const item of items) {
                    const img = item.querySelector("img");
                    try {
                        const dimensions = await loadImage(img.src);
                        images.push(dimensions);
                        item.dataset.pswpWidth = dimensions.width;
                        item.dataset.pswpHeight = dimensions.height;
                    } catch (error) {
                        console.error("Failed to load image:", img.src);
                        images.push({
                            aspectRatio: 1.5,
                            width: 1920,
                            height: 1280,
                        });
                    }
                    item.classList.remove("loading");
                }

                if (window.innerWidth > 768) {
                    const layout = calculateRowLayout(images, row.offsetWidth);
                    row.style.height = `${layout.height}px`;
                    items.forEach((item, index) => {
                        item.style.width = `${layout.widths[index]}px`;
                        item.style.flex = "none";
                    });
                }
            }

            async function layoutGallery() {
                const rows = Array.from(
                    document.querySelectorAll(".gallery-row"),
                );
                for (const row of rows) {
                    await layoutRow(row);
                }
                document.getElementById("gallery").classList.add("loaded");
            }

            // Event Handlers
            let resizeTimer;
            function handleResize() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    if (window.innerWidth > 768) layoutGallery();
                }, 250);
            }

            // PhotoSwipe Setup - Updated to use full-size images
            function initPhotoSwipe() {
                const lightbox = new PhotoSwipeLightbox({
                    gallery: "#gallery",
                    children: ".gallery-item",
                    pswpModule: PhotoSwipe,
                    bgOpacity: 1,
                    showHideAnimationType: "fade",
                    wheelToZoom: true,
                    pinchToClose: false,
                    closeOnVerticalDrag: true,
                    allowPanToNext: true,
                    loop: true,
                    showAnimationDuration: 400,
                    hideAnimationDuration: 400,
                    preload: [1, 2],
                    errorMsg: "Image cannot be loaded",
                });

                lightbox.addFilter("itemData", (itemData, index) => {
                    const element = itemData.element;
                    const fullSrc = element.dataset.fullSrc; // Use full-size image for PhotoSwipe
                    const img = element.querySelector("img");

                    return {
                        src: fullSrc, // Use full-size image
                        width: parseInt(element.dataset.pswpWidth),
                        height: parseInt(element.dataset.pswpHeight),
                        alt: img.alt,
                    };
                });

                lightbox.init();
            }

            // Initialize
            document.addEventListener("DOMContentLoaded", () => {
                generateGallery();
                layoutGallery();
                initPhotoSwipe();
                window.addEventListener("resize", handleResize);

                document
                    .querySelector(".back-to-top")
                    .addEventListener("click", (e) => {
                        e.preventDefault();
                        window.scrollTo({ top: 0, behavior: "smooth" });
                    });

                document.addEventListener("keydown", (e) => {
                    if (e.key === "g" && !e.target.matches("input, textarea")) {
                        e.preventDefault();
                        document
                            .querySelector(".gallery")
                            .scrollIntoView({ behavior: "smooth" });
                    }
                });
            });

            console.log('Gallery loaded • Press "g" to jump to gallery');
        </script>
    </body>
</html>
